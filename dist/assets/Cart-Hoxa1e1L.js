import{c as d,r as h,b as y,j as t,d as x}from"./index-B1Lz2HTr.js";import{c as r}from"./cartService-CBG5IxyE.js";import{T as f}from"./trash-2-CxyZRnqY.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],v=d("arrow-left",b);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=[["path",{d:"M5 12h14",key:"1ays0h"}]],C=d("minus",k);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],I=d("plus",S);function q(){try{const e=localStorage.getItem("user");if(e){const a=JSON.parse(e);return Number(a.id)}}catch{}return null}const L=()=>{const e=q(),[a,i]=h.useState([]),[u,c]=h.useState(""),j=y();if(h.useEffect(()=>{e&&r.getCart(e).then(s=>{i(s||[])}).catch(()=>i([]))},[e]),!e)return t.jsx("div",{className:"market-page",children:t.jsxs("main",{className:"content-wrapper cart-page-content",children:[t.jsx("h2",{className:"section-title",children:"ðŸ›’ Giá» hÃ ng cá»§a báº¡n"}),t.jsxs("div",{className:"empty-cart",children:[t.jsx("p",{children:"Báº¡n cáº§n Ä‘Äƒng nháº­p Ä‘á»ƒ xem giá» hÃ ng."}),t.jsx(x,{to:"/login",className:"continue-shopping-btn",children:"ÄÄƒng nháº­p ngay"})]})]})});const l=Array.isArray(a)?a:[],g=l.reduce((s,n)=>{const o=typeof n.price=="string"?Number(n.price):n.price;return s+o*n.quantity},0),p=async(s,n)=>{if(e){if(n<1){await m(s);return}try{await r.updateItem(e,s,n);const o=await r.getCart(e);i(o||[]),c("Cáº­p nháº­t sá»‘ lÆ°á»£ng thÃ nh cÃ´ng!"),setTimeout(()=>c(""),1200)}catch{}}},m=async s=>{if(e)try{await r.removeItem(e,s);const n=await r.getCart(e);i(n||[]),c("ÄÃ£ xÃ³a sáº£n pháº©m khá»i giá»!"),setTimeout(()=>c(""),1200)}catch{}},N=()=>{if(!a||a.length===0){c("Giá» hÃ ng cá»§a báº¡n Ä‘ang trá»‘ng.");return}j("/cart/checkout")};return t.jsx("div",{className:"market-page",children:t.jsxs("main",{className:"content-wrapper cart-page-content",children:[t.jsx("h2",{className:"section-title",children:"ðŸ›’ Giá» hÃ ng cá»§a báº¡n"}),u&&t.jsx("div",{className:"cart-notify",children:u}),l.length===0?t.jsxs("div",{className:"empty-cart",children:[t.jsx("p",{children:"Giá» hÃ ng cá»§a báº¡n Ä‘ang trá»‘ng."}),t.jsxs(x,{to:"/",className:"continue-shopping-btn",children:[t.jsx(v,{size:18})," Tiáº¿p tá»¥c mua sáº¯m"]})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"cart-table-container",children:t.jsxs("table",{className:"cart-table",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Sáº£n pháº©m"}),t.jsx("th",{children:"ÄÆ¡n giÃ¡"}),t.jsx("th",{children:"Sá»‘ lÆ°á»£ng"}),t.jsx("th",{children:"ThÃ nh tiá»n"}),t.jsx("th",{})]})}),t.jsx("tbody",{children:l.map(s=>t.jsxs("tr",{children:[t.jsx("td",{className:"product-col",children:t.jsxs("div",{className:"cart-product-info",children:[t.jsx("img",{src:s.image_url||"/img/default.jpg",alt:s.name,className:"cart-img"}),t.jsxs("div",{children:[t.jsx("p",{className:"cart-item-name",children:s.name}),t.jsxs("span",{className:"cart-item-unit",children:["ÄÆ¡n vá»‹: ",s.unit]})]})]})}),t.jsxs("td",{className:"price-col",children:[(typeof s.price=="string"?Number(s.price):s.price).toLocaleString("vi-VN"),"Ä‘"]}),t.jsx("td",{className:"quantity-col",children:t.jsxs("div",{className:"quantity-controls",children:[t.jsx("button",{onClick:()=>p(s.id,s.quantity-1),disabled:s.quantity<=1,children:t.jsx(C,{size:14})}),t.jsx("span",{children:s.quantity}),t.jsx("button",{onClick:()=>p(s.id,s.quantity+1),children:t.jsx(I,{size:14})})]})}),t.jsx("td",{className:"total-col",children:t.jsxs("strong",{children:[((typeof s.price=="string"?Number(s.price):s.price)*s.quantity).toLocaleString("vi-VN"),"Ä‘"]})}),t.jsx("td",{className:"action-col",children:t.jsx("button",{className:"remove-btn",onClick:()=>m(s.id),children:t.jsx(f,{size:18})})})]},s.id))})]})}),t.jsxs("div",{className:"cart-summary-footer",children:[t.jsxs("div",{className:"cart-total",children:[t.jsx("span",{children:"Tá»•ng cá»™ng:"}),t.jsxs("span",{className:"total-price",children:[g.toLocaleString("vi-VN"),"Ä‘"]})]}),t.jsx("button",{className:"checkout-btn",onClick:N,children:"Tiáº¿n hÃ nh thanh toÃ¡n"})]})]})]})})};export{L as default};
